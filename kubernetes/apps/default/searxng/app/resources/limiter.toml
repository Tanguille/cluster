# Allow in-cluster clients (e.g. ToolHive MCP pod) so they are not treated as bots.
# When X-Forwarded-For/X-Real-IP are missing (e.g. direct pod→service), REMOTE_ADDR is used;
# botdetection may log "header is not set" — safe to ignore for in-cluster callers.
# See: https://docs.searxng.org/admin/searx.limiter.html

[botdetection]
# When the direct connection is from these IPs (e.g. Envoy gateway), use X-Forwarded-For
# and X-Real-IP to get the client IP. Envoy sets these when forwarding.
trusted_proxies = [
  "127.0.0.0/8",
  "::1",
  "10.0.0.0/8",
  "172.16.0.0/12",
  "192.168.0.0/16",
  "100.64.0.0/10",
  "fd00::/8",
]

[botdetection.ip_lists]
pass_ip = [
  "10.0.0.0/8",     # Kubernetes pod CIDR (common)
  "172.16.0.0/12",  # Private range
  "192.168.0.0/16", # Private range
  "100.64.0.0/10",  # Cilium / shared address space
  "fe80::/10",      # IPv6 link-local
]
