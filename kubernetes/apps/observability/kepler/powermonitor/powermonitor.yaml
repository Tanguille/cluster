---
# PowerMonitor CR: operator deploys Kepler (DaemonSet + Service) in observability namespace.
# Name must be "power-monitor" (enforced by operator).
# Applied by a separate Kustomization with dependsOn: kepler so CRDs exist first.
apiVersion: kepler.system.sustainable.computing.io/v1alpha1
kind: PowerMonitor
metadata:
  name: power-monitor
  labels:
    app.kubernetes.io/name: powermonitor
    app.kubernetes.io/instance: powermonitor
    app.kubernetes.io/part-of: kepler-operator
spec:
  kepler:
    config:
      logLevel: info
    deployment:
      # Only run on nodes with kepler-node=true (control-2, control-3)
      nodeSelector:
        kubernetes.io/os: linux
        kepler-node: "true"
